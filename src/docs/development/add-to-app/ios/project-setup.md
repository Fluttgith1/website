---
title: Integrate a Flutter module into your iOS project
short-title: Integrate Flutter
description: Learn how to integrate a Flutter module into your existing iOS project.
---

## Integration steps

Flutter can be embedded into your existing iOS application in a piecemeal fashion as
frameworks or libraries.

## Create a Flutter module

In order to embed Flutter into your existing application, first create a Flutter module.

From the command line, run:

```terminal
cd some/path/
flutter create --template module my_flutter
```

TODO(jmagman): IDE instructions

This creates a Flutter module project at `some/path/my_flutter/`.

In that directory you can run the same `flutter` commands you would
in any other Flutter project, like `flutter run --debug` or `flutter build ios`.
You can also run in [Android Studio/IntelliJ][] or [VS Code][] with the Flutter and Dart plugins.
This will run a single-view example version of your module without being
embedded in your existing application. This can be useful for testing
quick, incremental changes with hot reload.

### Module organization
The `my_flutter` module directory structure is similar to a normal Flutter
application:

```text
my_flutter/
  .ios/
    Runner.xcworkspace
    Flutter/podhelper.rb
  lib/
    main.dart
  test/
  pubspec.yaml
```

Add your Dart code to the `lib/` directory.

You can add Flutter dependencies to `my_flutter/pubspec.yaml`, including Flutter plugins 
with iOS platform code.

There is a `.ios/` hidden subfolder which contains a Xcode workspace where you can 
run a stand-alone version of your module. It also contains helper scripts to embed
the module into your existing application with [CocoaPods][].

{{site.alert.note}}
Custom iOS code should be added to your existing application or a plugin, not
the module in `.ios/`. Changes made in `.ios/` will not be embedded in your existing application.
The directory can be regenerated by running `flutter clean` in the `my_flutter` directory.
{{site.alert.end}}

## Embed the Flutter module in your existing application

There are two ways to embed Flutter in your existing application.
1. Use the CocoaPods dependency manager and `flutter`. Recommended.
1. Create frameworks for the Flutter engine, your compiled Dart code, and all Flutter plugins.
Manually embed the frameworks and update your existing application's build settings in Xcode.

### Embed with CocoaPods and Flutter tools

This method requires every developer working on your project to have `flutter` and [CocoaPods][] installed.

The following example assumes your existing application and the Flutter module are in sibling directories.
If you have a different directory organization, you may need to adjust the relative paths.

```text
some/path/
  my_flutter/
    .ios/Flutter/podhelper.rb
  MyApp/
    Podfile
```

If your existing application (`MyApp`) does not already have a Podfile,  follow the
[CocoaPods getting started guide][] to add a `Podfile` to your project.

1. Add the following lines to your `Podfile`:

```ruby
  flutter_application_path = '../my_flutter'
  load File.join(flutter_application_path, '.ios', 'Flutter', 'podhelper.rb')
```

2. For each [Podfile target][] that needs to
embed Flutter, call `install_all_flutter_pods(flutter_application_path)`.

```ruby
  target 'MyApp' do
    install_all_flutter_pods(flutter_application_path)
  end
```

3. Run `pod install`.

{{site.alert.note}}
Whenever you change the Flutter plugin dependencies in `some/path/my_flutter/pubspec.yaml`,
you need to run `flutter pub get` from `some/path/my_flutter` to refresh the list
of plugins read by the `podhelper.rb` script. Then run `pod install` again from
`some/path/MyApp`.
{{site.alert.end}}

The `podhelper.rb` script ensures that your plugins, `Flutter.framework`, and
`App.framework` are embedded in your project.

You should now be able to build the project using `⌘B`.

### Under the hood

- `Flutter.framework` (the Engine library) is being embedded into your application by
CocoaPods as a vendored framework. This has to match up with the release type
(debug/profile/release) as well as the architecture for your app (arm*, 
x86_64, etc.).
- `App.framework` (your Flutter application binary) is being embedded into your
application by CocoaPods as a vendored framework.
- Flutter plugins with iOS platform code are added as CocoaPod pods.
- A build script is added to the Podfile targets that call `install_all_flutter_pods`
to ensure that the binaries you build stay up to date with the Dart code in
the Flutter module.  It also uses your Xcode build configuration (Debug, Profile, Release)
to embed the matching build mode type of `Flutter.framework` and `App.framework`.

### Embed frameworks in Xcode

Alternatively, you can generate the necessary frameworks and embed them in your application
by manually editing your existing Xcode project.

If you are using the above [Embed with CocoaPods and Flutter tools](#embed-with-CocoaPods-and-Flutter-tools)
method, you can skip these instructions.

Let's assume you want to generate the frameworks to `some/path/MyApp/Flutter/`.

```text
some/path/
  MyApp/
    Flutter/
      Debug/
        Flutter.framework
        App.framework
        FlutterPluginRegistrant.framework
        example_plugin.framework (each plugin with iOS platform code will be a separate framework)
      Profile/
        Flutter.framework
        App.framework
        FlutterPluginRegistrant.framework
        example_plugin.framework
      Release/
        Flutter.framework
        App.framework
        FlutterPluginRegistrant.framework
        example_plugin.framework
```

```terminal
$ flutter build ios-framework --output=some/path/MyApp/Flutter/
```

{{site.alert.tip}}
With Xcode 11 installed you can generate [XCFrameworks][] instead of universal frameworks by adding
the flags `--xcframework --no-universal`.
{{site.alert.end}}

Open your existing project in Xcode and drag the frameworks from `some/path/MyApp/Flutter/Release/` in Finder
into your targets's build settings > General > Frameworks, Libraries, and Embedded Content.
<div class="container">
  <div class="row">
    <div class="col-sm text-center">
      <figure class="figure">
        {% asset development/add-to-app/ios/project-setup/embed-xcode.png %}
        <figcaption class="figure-caption">
          Embed frameworks in Xcode
        </figcaption>
      </figure>
    </div>
  </div>
</div>

You should now be able to build the project using `⌘B`.

### Under the hood
- The frameworks are added to the target's Link Binary with Libraries and Embed Frameworks
build phases, respectively.
- `Flutter/Release/` is added to the Framework Search Paths build setting.
- `@executable_path/Frameworks` is added to Runpath Search Paths build setting if not
already present.

{{site.alert.tip}}
If you would like to embed the Debug version of the Flutter frameworks in your Debug build configuration
and the Release version in your Release configuration, in your MyApp.xcodeproj/project.pbxproj try
replacing `path = Flutter/Release/example.framework;`
with `path = "Flutter/$(CONFIGURATION)/example.framework";` for all added frameworks (note the added `"`).

You must also add `$(PROJECT_DIR)/Flutter/$(CONFIGURATION)` to your Framework Search Paths build setting.
{{site.alert.end}}

## Development
You can now [add a Flutter screen][] to your existing application.

[Android Studio/IntelliJ]: /docs/development/tools/android-studio#run-app-with-breakpoints
[VS Code]: /docs/development/tools/vs-code#run-app-with-breakpoints
[CocoaPods]: https://cocoapods.org/
[CocoaPods getting started guide]: https://guides.cocoapods.org/using/using-cocoapods.html
[Podfile target]: https://guides.cocoapods.org/syntax/podfile.html#target
[XCFrameworks]: https://developer.apple.com/documentation/xcode_release_notes/xcode_11_release_notes
[add a Flutter screen]: docs/development/add-to-app/ios/add-flutter-screen
