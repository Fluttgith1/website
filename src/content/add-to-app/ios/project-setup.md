---
title: Integrate a Flutter module into your iOS project
short-title: Integrate Flutter
description: Learn how to integrate a Flutter module into your existing iOS project.
---

Flutter UI components can be incrementally added into your existing iOS
application as embedded frameworks.
To embed Flutter in your existing application,
consider one of the following three methods.

**Use the CocoaPods dependency manager and installed Flutter SDK.**
: Each time you build the app,
  it compiles the `flutter_module` from source.
  (Recommended.)

**Create frameworks for each component.**
: Create frameworks for the Flutter engine, your compiled Dart code,
  and all Flutter plugins in Xcode.
  Embed these frameworks and update your existing application's build settings.
  This method works for teams that don't want to require every developer
  to install the Flutter SDK and CocoaPods on their local machines.

**Create frameworks for Dart code and Flutter plugins. Use CocoaPods for the Flutter engine.**
: Embed the frameworks for your iOS app and the plugins in Xcode,
  but distribute the Flutter engine as a CocoaPods podspec.
  This works like the second method,
  but it provides an alternative to distributing the large Flutter.xcframework.

For examples using an app built with UIKit,
see the iOS directories in the [add_to_app code samples][].
For an example using SwiftUI, consult the iOS directory in [News Feed App][].

## Watch the video

To learn more, watch this short video on adding Flutter to an iOS app:

<iframe class="full-width" src="{{site.yt.embed}}/IIcrfrTshTs" title="Learn about how to add Flutter to an existing iOS app" {{site.yt.set}}></iframe>

## System requirements

Your development environment must meet the
[macOS system requirements for Flutter][] with [Xcode installed][].
Flutter supports iOS {{site.targetmin.ios}} and later and [CocoaPods][] {{site.appmin.cocoapods}} or later.

## Create a Flutter module

To embed Flutter into your existing application with any method,
create a Flutter module first.
Use the following command to create a Flutter module.

```console
$ cd /path/to
$ flutter create --template module my_flutter
```

Flutter creates module project under `/path/to/my_flutter/`.
If you use Method A, the module should be created
in the same parent directory as your existing iOS app.

From the Flutter module directory, you can run the same `flutter`
commands you would in any other Flutter project,
like `flutter run` or `flutter build ios`.
You can also run the module in [VS Code][] or
[Android Studio/IntelliJ][] with the Flutter and Dart plugins.
This project contains a single-view example version of your module
before it's embedded in your existing iOS app.
This helps when testing the Flutter-only parts of your code.

### Organize your module

The `my_flutter` module directory structure resembles a typical Flutter app.

```plaintext
my_flutter/
├── .ios/
│   ├── Runner.xcworkspace
│   └── Flutter/podhelper.rb
├── lib/
│   └── main.dart
├── test/
└── pubspec.yaml
```

Your Dart code should be added to the `lib/` directory.
Your Flutter dependencies, packages, and plugins must be added to the
`pubspec.yaml` file.

The `.ios/` hidden subfolder contains an Xcode workspace where
you can run a standalone version of your module.
This wrapper project bootstraps your Flutter code.
It contains helper scripts to facilitate building frameworks or
embedding the module into your existing application with CocoaPods.

:::note
Add custom iOS code to your own existing application's
project or to a plugin, not to the module's `.ios/`
directory. Changes made in your module's `.ios/`
directory don't appear in your existing iOS project
using the module, and might be overwritten by Flutter.

Exclude the `.ios/` directory from source control as it's autogenerated.
Before building the module on a new machine, run `flutter pub get`
in the `my_flutter` directory first.
This regenerates the `.ios/` directory before building the iOS project
using the Flutter module.
:::

## Embed a Flutter module in your iOS app

After you have developed your Flutter module,
you can embed it using the methods described at the top of the page.

You can run in Debug mode on a simulator or a real device,
and Release on a real device.

Using Flutter [increases your app size][].

:::note
Learn more about [Flutter's build modes][build modes of Flutter].

To use Flutter debugging features such as hot reload,
consult [Debugging your add-to-app module][].
:::

### Method A - Embed with CocoaPods and the Flutter SDK {:#method-a}

#### Requirements {:#method-a-reqs}

Every developer working on your project must have a local version
of the Flutter SDK and CocoaPods installed.

#### Approach {:#method-a-approach}

This first method compiles your Dart and plugin code from source each time
Xcode builds the app.

This allows rapid iteration with the most up-to-date
version of your Flutter module without running additional
commands outside of Xcode.

#### Example project structure {:#method-a-structure}

The following example assumes that your existing app and the Flutter module
reside in sibling directories.
If you have a different directory structure, adjust the relative paths.

```plaintext
/path/to/
├── my_flutter/
│   └── .ios/
│       └── Flutter/
│         └── podhelper.rb
└── MyApp/
    └── Podfile
```

#### Update your Podfile

1. If your existing application (`MyApp`) doesn't already have a Podfile,
   use the `pod init` command in the `MyApp` directory to create one.

   To learn more about CocoaPods,
   consult the [CocoaPods getting started guide][].

1. Add the following lines at the top of your `Podfile`.

   ```ruby title="MyApp/Podfile"
   flutter_application_path = '../my_flutter'
   load File.join(flutter_application_path, '.ios', 'Flutter', 'podhelper.rb')
   ```

1. For each [Podfile target][] that needs to embed Flutter,
   add a call to `install_all_flutter_pods(flutter_application_path)`.

   ```ruby title="MyApp/Podfile"
   target 'MyApp' do
     install_all_flutter_pods(flutter_application_path)
   end
   ```

1. In the `Podfile`'s `post_install` block,
   add a call to `flutter_post_install(installer)`.

   ```ruby title="MyApp/Podfile"
   post_install do |installer|
     flutter_post_install(installer) if defined?(flutter_post_install)
   end
   ```

   :::note
   If your `Podfile` does not have a `post_install` block,
   add this code to the bottom of your `Podfile`.
   :::
   native Apple Silicon `arm64` iOS simulators.
   Include the `if defined?(flutter_post_install)`
   check to validate your `Podfile` if you are running on older versions
   of Flutter that lack this method.

1. Use the `flutter pub get` command to refresh plugins.

   When you change the Flutter dependencies in the `pubspec.yaml` file,
   run `flutter pub get` in your Flutter module directory.
   This refreshes the list of plugins that the `podhelper.rb` script reads.

1. Run the `pod install` command to embed the plugins and frameworks.

   From your iOS app project at `/path/to/MyApp`, run `pod install`.

   The `podhelper.rb` script embeds your plugins,
   `Flutter.framework`, and `App.framework` into your project.

   Your app's **Debug** and **Release** build configurations embed
   the **Debug** or **Release** [build modes of Flutter][], respectively.

   To test in profile mode, add a **Profile** build configuration to your app.

   :::tip
   `Flutter.framework` is the bundle for the Flutter engine,
   and `App.framework` is the compiled Dart and plugin code for this project.
   :::

1. Open `MyApp.xcworkspace` in Xcode.

1. To build the project, press <kbd>Cmd</kbd> + <kbd>B</kbd>.

### Method B - Embed frameworks in Xcode {:#method-b}

#### Requirements {:#method-b-reqs}

No additional software or hardware requirements are needed for this method.
Use this method in the following use cases:

* Members of your team can't install the Flutter SDK and CocoaPods
* You don't want to use CocoaPods as a dependency manager in existing iOS apps

#### Approach {:#method-b-approach}

In this second method, you edit your existing Xcode project,
generate the necessary frameworks, and embed them in your app.

Every time you change code in your Flutter module,
run `flutter build ios-framework`.

#### Example project structure {:#method-b-structure}

The following example assumes that you want to generate the
frameworks to `/path/to/MyApp/Flutter/`.

```console
$ flutter build ios-framework --output=/path/to/MyApp/Flutter/
```

The resulting project structure should resemble this directory tree.

```plaintext
/path/to/MyApp/
└── Flutter/
    ├── Debug/
    │   ├── Flutter.xcframework
    │   ├── App.xcframework
    │   ├── FlutterPluginRegistrant.xcframework (only if you have plugins with iOS platform code)
    │   └── example_plugin.xcframework (each plugin is a separate framework)
    ├── Profile/
    │   ├── Flutter.xcframework
    │   ├── App.xcframework
    │   ├── FlutterPluginRegistrant.xcframework
    │   └── example_plugin.xcframework
    └── Release/
        ├── Flutter.xcframework
        ├── App.xcframework
        ├── FlutterPluginRegistrant.xcframework
        └── example_plugin.xcframework
```

:::warning
Always put `Flutter.xcframework` and `App.xcframework` from the same directory.
Mixing `.xcframework` imports from different directories
(like `Profile/Flutter.xcframework` with `Debug/App.xcframework`)
causes runtime crashes.
:::

#### Procedures

You can either link or embed the generated frameworks
into your existing app in Xcode.
Use the method that is best for your project.

##### Link on the frameworks

For example, you can drag the frameworks from
`/path/to/MyApp/Flutter/Release/` in the Finder into your target's
**Build Settings > Build Phases > Link Binary With Libraries**.

In the target's build settings, add `$(PROJECT_DIR)/Flutter/Release/`
to the **Framework Search Paths** (`FRAMEWORK_SEARCH_PATHS`).

{% render docs/captioned-image.liquid, image:"development/add-to-app/ios/project-setup/framework-search-paths.png", caption:"Update Framework Search Paths in Xcode" %}

:::tip
To use the simulator, embed the Debug version of the Flutter frameworks
in your Debug build configuration.
To do this, use `$(PROJECT_DIR)/Flutter/$(CONFIGURATION)`
in the **Framework Search Paths** (`FRAMEWORK_SEARCH_PATHS`) build setting.
This embeds the Release frameworks in the Release configuration,
and the Debug frameworks in the Debug Configuration.

You must also open `MyApp.xcodeproj/project.pbxproj` (from Finder)
and replace `path = Flutter/Release/example.xcframework;`
with `path = "Flutter/$(CONFIGURATION)/example.xcframework";`
for all added frameworks. The double quotes (`"`) are necessary.
:::

##### Embed the frameworks

To load the generated dynamic frameworks at runtime,
embed them into your app.

:::important
Plugins might produce [static or dynamic frameworks][].
Static frameworks should be linked on, but never embedded.
If you embed a static framework into your iOS app,
you can't publish that app to the App Store.
Publishing then fails with a
**Found an unexpected Mach-O header code** archive error.
:::

After linking the frameworks, they should appear in the
**Frameworks, Libraries, and Embedded Content**
section of your target's **General** settings.

To embed the dynamic frameworks, select **Embed & Sign**.
They then appear under **Embed Frameworks** within **Build Phases** as shown.

{% render docs/captioned-image.liquid, image:"development/add-to-app/ios/project-setup/embed-xcode.png", caption:"Embed frameworks in Xcode" %}

You should now be able to build the project in Xcode using `⌘B`.

### Method C - Embed app and plugin frameworks in Xcode; Flutter framework with CocoaPods {:#method-c}

#### Requirements {:#method-c-reqs}

This method has the same requirements as Method B.

#### Approach {:#method-c-approach}

This method generates Flutter as a CocoaPods `.podspec` file instead of
distributing the large `Flutter.xcframework` to other developers,
machines, or continuous integration systems.
Flutter still generates the `App.xcframework` and plugin frameworks
as described in Option B.

#### Example project structure {:#method-c-structure}

To generate the `Flutter.podspec` and frameworks,
run the following command in the root of your Flutter module.

```console
$ flutter build ios-framework --cocoapods --output=/path/to/MyApp/Flutter/
```

The resulting project structure should resemble this directory tree.

```plaintext
/path/to/MyApp/
└── Flutter/
    ├── Debug/
    │   ├── Flutter.podspec
    │   ├── App.xcframework
    │   ├── FlutterPluginRegistrant.xcframework
    │   └── example_plugin.xcframework (each plugin with iOS platform code is a separate framework)
    ├── Profile/
    │   ├── Flutter.podspec
    │   ├── App.xcframework
    │   ├── FlutterPluginRegistrant.xcframework
    │   └── example_plugin.xcframework
    └── Release/
        ├── Flutter.podspec
        ├── App.xcframework
        ├── FlutterPluginRegistrant.xcframework
        └── example_plugin.xcframework
```

#### Add Flutter to your Podfile

Host apps using CocoaPods can add Flutter to their Podfile.

```ruby title="MyApp/Podfile"
pod 'Flutter', :podspec => '/path/to/MyApp/Flutter/[build mode]/Flutter.podspec'
```

:::note
You must hard code the `[build mode]` value.
For example, use `Debug` if you need to use `flutter attach`
and `Release` when you're ready to ship.
:::

Link and embed the generated App.xcframework,
FlutterPluginRegistrant.xcframework,
and any plugin frameworks into your existing application
as described in Option B.

## Local Network Privacy Permissions

On iOS 14 and later, enable the Dart multicast DNS service in the
Debug version of your app to add
[debugging functionalities such as hot-reload and DevTools][]
using `flutter attach`.

:::warning
This service must not be enabled in the **Release**
version of your app, or you might experience App Store rejections.
:::

Maintain a separate copy of your app's Info.plist per build configuration.
The following instructions assume the default **Debug** and **Release**.
Adjust the names as needed depending on your app's build configurations.

1. Rename your app's **Info.plist** to **Info-Debug.plist**.

1. Copy the plist and call it **Info-Release.plist**.

1. Add **Info-Release.plist** to your Xcode project.

    {% render docs/captioned-image.liquid,
    image:"development/add-to-app/ios/project-setup/info-plists.png",
    caption:"Info-Debug.plist and Info-Release.plist in Xcode" %}

1. In **Info-Debug.plist** _only_ add the key `NSBonjourServices`.

1. Set the value to an array with the string `_dartVmService._tcp`.
   Xcode displays this as "Bonjour services".

1. (Optional) Add the key `NSLocalNetworkUsageDescription` set to your
   desired customized permission dialog text.

   {% render docs/captioned-image.liquid, image:"development/add-to-app/ios/project-setup/debug-plist.png", caption:"Info-Debug.plist with additional keys" %}

1. In your target's build settings,
   change the **Info.plist File** (`INFOPLIST_FILE`) setting path
   from `path/to/Info.plist` to `path/to/Info-$(CONFIGURATION).plist`.

   {%- render docs/captioned-image.liquid, image:"development/add-to-app/ios/project-setup/set-plist-build-setting.png", caption:"Set INFOPLIST_FILE build setting" %}

   This resolves to the path **Info-Debug.plist** in **Debug** and
   **Info-Release.plist** in **Release**.

   {% render docs/captioned-image.liquid, image:"development/add-to-app/ios/project-setup/plist-build-setting.png", caption:"Resolved INFOPLIST_FILE build setting" %}

   You can also set the **Debug** path to **Info-Debug.plist**
   and the **Release** path to **Info-Release.plist**.

1. If the `Info-Release.plist` copy is in your target's
   **Build Settings** <span aria-label="and then">></span>
   **Build Phases** <span aria-label="and then">></span>
   **Copy Bundle Resources** build phase,
   remove it.

   {% include docs/captioned-image.liquid, image:"development/add-to-app/ios/project-setup/copy-bundle.png", caption:"Copy Bundle build phase" %}

1. The first Flutter screen your Debug app loads prompts
   for local network permission.

   Click **OK**.

   (Optional) To grant permission before the app loads, enable
   **Settings > Privacy > Local Network > Your App**.

## Apple Silicon (`arm64` Macs)

On an Apple Silicon (M1) Mac, the host app builds for an `arm64` simulator.
While Flutter supports `arm64` simulators, some plugins might not.
If you use one of these plugins, you might see a compilation error like
**Undefined symbols for architecture arm64**.
If this occurs,
exclude `arm64` from the simulator architectures in your host app.

1. In your host app target,
   find the **Excluded Architectures** (`EXCLUDED_ARCHS`) build setting.

1. Click the right arrow disclosure indicator icon
   to expand the available build configurations.

1. Hover over **Debug**.

1. Click the plus icon.

1. Change **Any SDK** to **Any iOS Simulator SDK**.

1. Add `arm64` to the build settings value.

    {% render docs/captioned-image.liquid,
    image:"development/add-to-app/ios/project-setup/excluded-archs.png",
    caption:"Set conditional EXCLUDED_ARCHS build setting" %}  
    When successful,
    Xcode adds `"EXCLUDED_ARCHS[sdk=iphonesimulator*]" = arm64;`
    to your **project.pbxproj** file.

1. Repeat for any iOS unit test targets.

## Development

You can now [add a Flutter screen][] to your existing iOS app.

[add_to_app code samples]: {{site.repo.samples}}/tree/main/add_to_app
[add a Flutter screen]: /add-to-app/ios/add-flutter-screen
[Android Studio/IntelliJ]: /tools/android-studio
[build modes of Flutter]: /testing/build-modes
[CocoaPods]: https://cocoapods.org/
[CocoaPods getting started guide]: https://guides.cocoapods.org/using/using-cocoapods.html
[debugging functionalities such as hot-reload and DevTools]: /add-to-app/debugging
[increases your app size]: /resources/faq#how-big-is-the-flutter-engine
[macOS system requirements for Flutter]: /get-started/install/macos/mobile-ios#verify-system-requirements
[Podfile target]: https://guides.cocoapods.org/syntax/podfile.html#target
[static or dynamic frameworks]: {{site.so}}/questions/32591878/ios-is-it-a-static-or-a-dynamic-framework
[VS Code]: /tools/vs-code
[Xcode installed]: /get-started/install/macos/mobile-ios#install-and-configure-xcode
[News Feed app]: https://github.com/flutter/put-flutter-to-work/tree/022208184ec2623af2d113d13d90e8e1ce722365
[Debugging your add-to-app module]: /add-to-app/debugging/

[embed the frameworks]: /add-to-app/ios/project-setup#embed-the-frameworks
[Embed with CocoaPods and Flutter tools]: #option-a---embed-with-cocoapods-and-the-flutter-sdk
[On iOS 14 and higher]: {{site.apple-dev}}/news/?id=0oi77447
[XCFrameworks]: {{site.apple-dev}}/documentation/xcode_release_notes/xcode_11_release_notes
